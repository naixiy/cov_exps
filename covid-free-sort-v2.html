<!DOCTYPE html>
<html>
  <head>
    <script src="jspsych.js"></script>
    <script src="pluginmods/jspsych-free-sort-mda.js"></script>
    <script src="plugins/jspsych-canvas-keyboard-response.js"></script>
    <script src="plugins/jspsych-html-keyboard-response.js"></script>
    <link rel="stylesheet" href="css/jspsych.css">
  </head>
  <body></body>
  <script>

  var trial_1 = {
    type: 'free-sort',
    stimuli: ['images/A01.png','images/A02.png','images/A03.png','images/A04.png'],
    stim_height: 50,
    stim_width: 50,
    prompt: 'Please group similar expressions together. ',
    prompt_location: "below",
    sort_area_height: 500,
    sort_area_width: 600,
    sort_area_shape: "square",
    scale_factor: 1.2,
    border_color_in: '#DCDCDC',
    border_color_out: 'red'
  };

  var trial_2 = {
    type: 'free-sort',
    stimuli: ['images/happy_face_1.jpg','images/happy_face_3.jpg','images/sad_face_2.jpg','images/sad_face_4.jpg'],
    stim_height: 120,
    stim_width: 160,
    prompt: '<p>Arrange the faces.</p>',
    prompt_location: "below",
    sort_area_height: 500,
    sort_area_width: 600,
    sort_area_shape: "square",
    scale_factor: 1.2,
    border_color_in: '#DCDCDC',
    border_color_out: 'red'
  };

  var trial_3 = {
    type: 'canvas-keyboard-response',
    stimulus: function(c) {
      c.style.border = "5px solid #A9A9A9";
      // present images on a canvas at specific locations
      var ctx = c.getContext('2d');
      var img1 = new Image();
      var img2 = new Image();
      var img3 = new Image();
      img1.src = 'images/1.gif';
      img2.src = 'images/2.gif';
      img3.src = 'images/3.gif';
      img1.addEventListener('load', function() {
        ctx.drawImage(img1, 0, 0, 90, 90);
      }, false);
      img2.addEventListener('load', function() {
        ctx.drawImage(img2, 500, 600,  90, 90);
      }, false);
      img3.addEventListener('load', function() {
        ctx.drawImage(img3, 300, 100,  90, 90);
      }, false);
    },
    canvas_size: [700,700],
    prompt: "Memorize the image locations (5s).",
    choices: jsPsych.NO_KEYS,
    trial_duration: 5000
  };

  var trial_4 = {
    type: 'free-sort',
    stimuli: ['images/1.gif','images/2.gif','images/3.gif'],
    stim_height: 90,
    stim_width: 90,
    scale_factor: 1.0,
    prompt: '<p>Where were the images?</p>',
    prompt_location: 'below',
    sort_area_shape: "square",
    change_border_background_color: false,
    border_width: 5,
    counter_text_unfinished: "Not done yet...",
    counter_text_finished: "Done!"
  };



  var trial_5 = {
    type: 'free-sort-mda',
    stimuli: ['images/lego_red.png','images/lego.png'],//,'images/A03.png','images/A04.png'],
    prompt: '<p>Welcome to the park. You are the person wearing black. The only other person instead the park (wearing red) is not wearing a mask.</p>',
    change_border_background_color: true,
    border_color_in:  "#1e8449",
    border_color_out: "#196f3d",
    stim_height: 120,
    border_width: 10,
    counter_text_unfinished: "<b>You need to be IN the park.</b>",
    counter_text_finished: "<b>Move if you like; press continue when you're happy with your position.</b>",
    stim_starts_inside: true,
    sort_area_shape: "ellipse"
  };

  var instructions_1 = {
    type: 'html-keyboard-response',
    stimulus: 'You have an exciting day ahead of you.<br><br>You are going to the park, and then to the pub.<br><br>You are <b>not</b> wearing a mask.<br><br>Press any key to continue.'
  };

  var instructions_2 = {
    type: 'html-keyboard-response',
    stimulus: 'First, you go and stand in the park. There is one other person - a stranger - in the park too.<br><br>Press any key to continue.'
  };

  var trial_5a = {
    type: 'free-sort-mda',
    stimuli: ['images/lego_red.png','images/lego_blue_shorts.png'],//,'images/A03.png','images/A04.png'],
    prompt: '<p>Welcome to the park. You are wearing a black top and blue shorts. The stranger inside the park is not wearing a mask. Because they are wearing <b>red</b>, you know they are an outgroup member...</p>',
    change_border_background_color: true,
    border_color_in:  "#1e8449",
    border_color_out: "#196f3d",
    stim_height: 120,
    border_width: 10,
    counter_text_unfinished: "<b>You need to be IN the park.</b>",
    counter_text_finished: "<b>Move if you like; press continue when you're happy with your position.</b>",
    stim_starts_inside: true,
    sort_area_shape: "ellipse"
  };

  var instructions_3 = {
    type: 'html-keyboard-response',
    stimulus: 'You are still in the park, and have walked around a bit. The stranger has gone away, but you see your close friend and stop to talk to them.<br><br>Press any key to continue.'
  };

  var trial_5b = {
    type: 'free-sort-mda',
    stimuli: ['images/lego_mask_blue.png','images/lego_blue_shorts.png'],//,'images/A03.png','images/A04.png'],
    prompt: '<p>You are still in the park (wearing a black top and blue shorts). Your friend (wearing all blue) is wearing a mask.</p>',
    change_border_background_color: true,
    border_color_in:  "#1e8449",
    border_color_out: "#196f3d",
    stim_height: 120,
    border_width: 10,
    counter_text_unfinished: "<b>You need to stay IN the park.</b>",
    counter_text_finished: "<b>If you're happy with where you're standing to talk to your friend for 10 minutes, click continue. If not, you can move yourself first.</b>",
    stim_starts_inside: true,
    sort_area_shape: "ellipse"
  };

  var instructions_4 = {
    type: 'html-keyboard-response',
    stimulus: "You and your friend somehow find an open pub, so decide to party like it's 2019...<br><br>Press any key to continue."
  };

  var trial_5c = {
    type: 'free-sort-mda',
    stimuli: ['images/lego_mask_blue.png','images/lego_blue_shorts.png'],//,'images/A03.png','images/A04.png'],
    prompt: '<p>You are now in the pub (wearing a black top and blue shorts). Your friend (wearing all blue) is wearing a mask.<br><br>Choose a place to stand for the 15 minutes it will take to finish your drink.</p>',
    change_border_background_color: true,
    border_color_in:  "#873600",
    border_color_out: "#784212",
    stim_height: 120,
    border_width: 10,
    counter_text_unfinished: "<b>You haven't finished your pint yet! Go back inside.</b>",
    counter_text_finished: "<b>If you're happy with where you're standing, click continue. If not, you can move yourself first.</b>",
    stim_starts_inside: true,
    sort_area_shape: "square"
  };

  var instructions_5 = {
    type: 'html-keyboard-response',
    stimulus: "There's lots of ways we can play with context. We can have a lot more people in the park/pub. We can manipulate public/private and indoor/outdoor, with/without masks, and familiars/strangers.<br><br>\
    We could also add a motivation for not just being as far away as the other people as possible. For example, by motivating being near the bar/school gates/front of the queue/not so far away from other people it's socially awkward etc.<br><br>\
    But if we only have 1 person to place, and 1 person to measure the distance from, arguably we could just do this on a line rather than in 2D.<br><br>THE END."
  };

  var trial_5d = {
    type: 'free-sort-mda',
    stimuli: ['images/lego_mask_blue.png','images/lego_blue_shorts.png'],//,'images/A03.png','images/A04.png'],
    prompt: '<p>You are now in the pub (wearing a black top and blue shorts). Your friend (wearing all blue) is wearing a mask.<br><br><br><br><br><br><br><br><br><br><br><br><br></p>',
    change_border_background_color: true,
    border_color_in:  "#873600",
    border_color_out: "#784212",
    stim_height: 120,
    border_width: 10,
    sort_area_height: 1,
    counter_text_unfinished: "",
    counter_text_finished: "",
    stim_starts_inside: true,
    sort_area_shape: "square"
  };

  var instructions_6 = {
    type: 'html-keyboard-response',
    stimulus: "END.<br><br>So obviously we'd need to have a proper think about the contexts, setting up the conditions, and thinking more seriously about the images we want to use, but hopefully that gives you some idea of what we could do with this DV?<br><br>Press any key to end."
  };

  /*var trial_6 = {
    type: 'free-sort-mda',
    stimuli: ['images/A01.png','images/N03.png','images/A03.png','images/A04.png'],
    prompt: '<p>And one where someone is wearing a mask...</p>',
    change_border_background_color: false,
    border_width: 3,
    counter_text_unfinished: "",
    counter_text_finished: "",
    stim_starts_inside: true,
    sort_area_shape: "square"
  };*/

  jsPsych.init({
    //timeline: [trial_1, trial_2, trial_3, trial_4, trial_5],
    timeline: [instructions_1,instructions_2,trial_5a,instructions_3,trial_5b,instructions_4,trial_5c,instructions_5],//,instructions_6],// trial_6],
    on_finish: function(){jsPsych.data.displayData();}
  });


  </script>
</html>
